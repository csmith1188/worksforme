<%- include('../partials/header.ejs', {pageTitle: 'Calendar'}); %>

<link rel="stylesheet" href="/public/css/calendar.css">

    <div class="mainContainer">
        <div class="content">
            <h1 id="week-title">Week of <span id="week-of"></span></h1>
            <div id="controls">
                <input type="date" id="date-select">

                <button id="prev-week-btn" class=""><</button>
                <button id="next-week-btn">></button>
            </div>
            <br>
            <div id="day-headers">
                <% const daysOfTheWeek = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday']; %>
                <% for (let i = 0; i < daysOfTheWeek.length; i++) { %>
                    <div class="day-header <%= (i === 0) ? 'first' : ''; %>">
                        <span class="day-text"><%= daysOfTheWeek[i] %></span>
                        <br>
                        <span class="date-text" id="date-text-<%= i %>"><%= i+1 %></span>
                    </div>
                <% } %>
            </div>

            <div id="grid">
                <div id="cells">
                    <% for (let i = 0; i < 7; i++) { %>
                        <div class="day-column" data-index="<%= i %>">
                            <div class="time-blocks"></div>
                            <% for (let j = 0; j < 24; j++) { %>
                                <div class="cell <%= (i % 7 === 0) ? 'first' : ''; %>" data-hour="<%= j %>">
                                    <div class="inner-cell"></div>
                                </div>
                            <% } %>
                        </div>
                    <% } %>
                </div>
            </div>
        </div>
    </div>
    <script>
        let userCalendar;
        fetch('/calendar/get-calendar-data', { method: 'POST' })
            .then(response => response.json())
            .then(data => {
                // Process the data and update the calendar
                console.log(data);
                userCalendar = new Map(Object.entries(data));
                initCalendar(userCalendar);
            })
            .catch(error => console.error('Error fetching calendar data:', error));
    </script>
    <script src="/public/clientJS/dayjs.min.js"></script>
    <script src="/public/clientJS/calendar.js"></script>

<%- include('../partials/footer.ejs') %>